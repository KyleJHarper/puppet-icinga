<%
  #
  # The following definitions help with validation.
  #
  # Note: when the value passed is '' it will be commented out in the config, so we leave.
  def zero_or_one(attribute, value)
    return if value == ''
    value =~ /[01]/ or fail("The attribute '#{attribute}' must be 0 or 1, not '#{value}'.")
  end

  def one_of(attribute, value, allowed, pattern = '[a-z](,[a-z])*')
    return if value == ''
    value =~ /#{pattern}/ or fail("The attribute '#{attribute}' must be a csv matching pattern '#{pattern}', not '#{value}'.")
    value.split(',').each do |token|
      allowed.include?(token) or fail("The attribute '#{attribute}' does not allow the token '#{token}' found in value '#{value}'.")
    end
    if value.split(',').include?('n') and value.split(',').size > 1 ; then
      fail("Specifying 'n' overrides other flags in the attribute '#{attribute}', you provided '#{value}'.  While it works, it's obnoxious.")
    end
  end

  def is_a_float(attribute, value)
    return if value == ''
    value =~ /^(([0-9]+([.][0-9]+)?)|([.][0-9]+))$/ or fail("The attribute '#{attribute}' must be an integer or float, not '#{value}'.")
  end

  def is_an_integer(attribute, value)
    return if value == ''
    if value != :undef and value !~ /^[-]?[0-9]+$/ ; then
      fail("The attribute '#{attribute}' must be an integer, not '#{value}'.")
    end
  end

  def not_blank(attribute, value)
    if value.nil? or value == '' then
      fail("The attribute '#{attribute}' cannot be blank, nil, or undef.")
    end
  end


  # -- Actual checks.  Could be DRY'd up but it'll make the defs even more complex to read.
  #
  #                                                          \|/ Alphabetical by attribute
  not_blank('ICINGACFG',                                     @ICINGACFG)
  not_blank('CGICFG',                                        @CGICFG)
  is_an_integer('NICENESS',                                  @NICENESS)
  one_of('IDO2DB',                                           @IDO2DB, ['yes','no'])
  not_blank('TMPDIR',                                        @TMPDIR)
  zero_or_one('accept_passive_host_checks',                  @accept_passive_host_checks)
  zero_or_one('accept_passive_service_checks',               @accept_passive_service_checks)
  is_an_integer('additional_freshness_latency',              @additional_freshness_latency)
  not_blank('admin_email',                                   @admin_email)
  not_blank('admin_pager',                                   @admin_pager)
  zero_or_one('allow_empty_hostgroup_assignment',            @allow_empty_hostgroup_assignment)
  zero_or_one('auto_reschedule_checks',                      @auto_reschedule_checks)
  is_an_integer('auto_rescheduling_interval',                @auto_rescheduling_interval)
  is_an_integer('auto_rescheduling_window',                  @auto_rescheduling_window)
  not_blank('broker_module',                                 @broker_module)
  is_an_integer('cached_host_check_horizon',                 @cached_host_check_horizon)
  is_an_integer('cached_service_check_horizon',              @cached_service_check_horizon)
  not_blank('cfg_dirs',                                      @cfg_dirs)
  not_blank('cfg_files',                                     @cfg_files)
  zero_or_one('check_external_commands',                     @check_external_commands)
  zero_or_one('check_for_orphaned_hosts',                    @check_for_orphaned_hosts)
  zero_or_one('check_for_orphaned_services',                 @check_for_orphaned_services)
  zero_or_one('check_host_freshness',                        @check_host_freshness)
  not_blank('check_result_path',                             @check_result_path)
  is_an_integer('check_result_reaper_frequency',             @check_result_reaper_frequency)
  is_an_integer('check_service_freshness',                   @check_service_freshness)
  zero_or_one('child_processes_fork_twice',                  @child_processes_fork_twice)
  not_blank('command_check_interval',                        @command_check_interval)
  not_blank('command_file',                                  @command_file)
  zero_or_one('daemon_dumps_core',                           @daemon_dumps_core)
  not_blank('date_format',                                   @date_format)
  not_blank('debug_file',                                    @debug_file)
  is_an_integer('debug_level',                               @debug_level)
  is_an_integer('debug_verbosity',                           @debug_verbosity)
  one_of('debug_verbosity',                                  @debug_verbosity, ['0','1','2'], '[-]?[0-9]+(,[0-9]+)*')
  zero_or_one('dump_retained_host_service_states_to_neb',    @dump_retained_host_service_states_to_neb)
  zero_or_one('enable_embedded_perl',                        @enable_embedded_perl)
  zero_or_one('enable_environment_macros',                   @enable_environment_macros)
  zero_or_one('enable_event_handlers',                       @enable_event_handlers)
  zero_or_one('enable_flap_detection',                       @enable_flap_detection)
  zero_or_one('enable_notifications',                        @enable_notifications)
  zero_or_one('enable_predictive_host_dependency_checks',    @enable_predictive_host_dependency_checks)
  zero_or_one('enable_predictive_service_dependency_checks', @enable_predictive_service_dependency_checks)
  zero_or_one('enable_state_based_escalation_ranges',        @enable_state_based_escalation_ranges)
  is_an_integer('event_broker_options',                      @event_broker_options)
  is_an_integer('event_handler_timeout',                     @event_handler_timeout)
  zero_or_one('event_profiling_enabled',                     @event_profiling_enabled)
  zero_or_one('execute_host_checks',                         @execute_host_checks)
  zero_or_one('execute_service_checks',                      @execute_service_checks)
  is_an_integer('external_command_buffer_slots',             @external_command_buffer_slots)
  zero_or_one('free_child_process_memory',                   @free_child_process_memory)
  #('global_host_event_handler',                              @global_host_event_handler)
  #('global_service_event_handler',                           @global_service_event_handler)
  is_a_float('high_host_flap_threshold',                     @high_host_flap_threshold)
  is_a_float('high_service_flap_threshold',                  @high_service_flap_threshold)
  is_an_integer('host_check_timeout',                        @host_check_timeout)
  is_an_integer('host_freshness_check_interval',             @host_freshness_check_interval)
  one_of('host_inter_check_delay_method',                    @host_inter_check_delay_method, ['d','n','s'])
  #('host_perfdata_command',                                  @host_perfdata_command)
  one_of('host_perfdata_file_mode',                          @host_perfdata_file_mode, ['a','p','w'])
  not_blank('host_perfdata_file_processing_command',         @host_perfdata_file_processing_command)
  is_an_integer('host_perfdata_file_processing_interval',    @host_perfdata_file_processing_interval)
  not_blank('host_perfdata_file_template',                   @host_perfdata_file_template)
  not_blank('host_perfdata_file',                            @host_perfdata_file)
  zero_or_one('host_perfdata_process_empty_results',         @host_perfdata_process_empty_results)
  not_blank('icinga_group',                                  @icinga_group)
  not_blank('icinga_user',                                   @icinga_user)
  not_blank('illegal_macro_output_chars',                    @illegal_macro_output_chars)
  not_blank('illegal_object_name_chars',                     @illegal_object_name_chars)
  is_an_integer('interval_length',                           @interval_length)
  zero_or_one('keep_unknown_macros',                         @keep_unknown_macros)
  not_blank('lock_file',                                     @lock_file)
  not_blank('log_archive_path',                              @log_archive_path)
  zero_or_one('log_current_states',                          @log_current_states)
  zero_or_one('log_event_handlers',                          @log_event_handlers)
  zero_or_one('log_external_commands',                       @log_external_commands)
  not_blank('log_file',                                      @log_file)
  zero_or_one('log_host_retries',                            @log_host_retries)
  zero_or_one('log_initial_states',                          @log_initial_states)
  zero_or_one('log_long_plugin_output',                      @log_long_plugin_output)
  zero_or_one('log_notifications',                           @log_notifications)
  zero_or_one('log_passive_checks',                          @log_passive_checks)
  one_of('log_rotation_method',                              @log_rotation_method, ['d','h','m','n','w'])
  zero_or_one('log_service_retries',                         @log_service_retries)
  is_a_float('low_host_flap_threshold',                      @low_host_flap_threshold)
  is_a_float('low_service_flap_threshold',                   @low_service_flap_threshold)
  is_an_integer('max_check_result_file_age',                 @max_check_result_file_age)
  is_an_integer('max_check_result_list_items',               @max_check_result_list_items)
  is_an_integer('max_check_result_reaper_time',              @max_check_result_reaper_time)
  is_an_integer('max_concurrent_checks',                     @max_concurrent_checks)
  is_an_integer('max_debug_file_size',                       @max_debug_file_size)
  is_an_integer('max_host_check_spread',                     @max_host_check_spread)
  is_an_integer('max_service_check_spread',                  @max_service_check_spread)
  is_an_integer('notification_timeout',                      @notification_timeout)
  not_blank('object_cache_file',                             @object_cache_file)
  zero_or_one('obsess_over_hosts',                           @obsess_over_hosts)
  zero_or_one('obsess_over_services',                        @obsess_over_services)
  #('ochp_command',                                           @ochp_command)
  #('ocsp_command',                                           @ocsp_command)
  is_an_integer('ocsp_timeout',                              @ocsp_timeout)
  not_blank('p1_file',                                       @p1_file)
  zero_or_one('passive_host_checks_are_soft',                @passive_host_checks_are_soft)
  is_an_integer('perfdata_timeout',                          @perfdata_timeout)
  not_blank('precached_object_file',                         @precached_object_file)
  zero_or_one('process_performance_data',                    @process_performance_data)
  not_blank('resource_file',                                 @resource_file)
  is_an_integer('retained_contact_host_attribute_mask',      @retained_contact_host_attribute_mask)
  is_an_integer('retained_contact_service_attribute_mask',   @retained_contact_service_attribute_mask)
  is_an_integer('retained_host_attribute_mask',              @retained_host_attribute_mask)
  is_an_integer('retained_process_host_attribute_mask',      @retained_process_host_attribute_mask)
  is_an_integer('retained_process_service_attribute_mask',   @retained_process_service_attribute_mask)
  is_an_integer('retained_service_attribute_mask',           @retained_service_attribute_mask)
  zero_or_one('retain_state_information',                    @retain_state_information)
  is_an_integer('retention_update_interval',                 @retention_update_interval)
  is_an_integer('service_check_timeout',                     @service_check_timeout)
  one_of('service_check_timeout_state',                      @service_check_timeout_state, ['c','d','u','w'])
  is_an_integer('service_freshness_check_interval',          @service_freshness_check_interval)
  one_of('service_inter_check_delay_method',                 @service_inter_check_delay_method, ['d','n','s'])
  not_blank('service_interleave_factor',                     @service_interleave_factor)
  #('service_perfdata_command',                               @service_perfdata_command)
  one_of('service_perfdata_file_mode',                       @service_perfdata_file_mode, ['a','p','w'])
  not_blank('service_perfdata_file_processing_command',      @service_perfdata_file_processing_command)
  is_an_integer('service_perfdata_file_processing_interval', @service_perfdata_file_processing_interval)
  not_blank('service_perfdata_file_template',                @service_perfdata_file_template)
  not_blank('service_perfdata_file',                         @service_perfdata_file)
  zero_or_one('service_perfdata_process_empty_results',      @service_perfdata_process_empty_results)
  is_a_float('sleep_time',                                   @sleep_time)
  zero_or_one('soft_state_dependencies',                     @soft_state_dependencies)
  zero_or_one('stalking_event_handlers_for_hosts',           @stalking_event_handlers_for_hosts)
  zero_or_one('stalking_event_handlers_for_services',        @stalking_event_handlers_for_services)
  zero_or_one('stalking_notifications_for_hosts',            @stalking_notifications_for_hosts)
  zero_or_one('stalking_notifications_for_services',         @stalking_notifications_for_services)
  not_blank('state_retention_file',                          @state_retention_file)
  not_blank('status_file',                                   @status_file)
  is_an_integer('status_update_interval',                    @status_update_interval)
  #('sync_retention_file',                                    @sync_retention_file)
  is_an_integer('syslog_local_facility',                     @syslog_local_facility)
  not_blank('temp_file',                                     @temp_file)
  not_blank('temp_path',                                     @temp_path)
  is_an_integer('time_change_threshold',                     @time_change_threshold)
  zero_or_one('translate_passive_host_checks',               @translate_passive_host_checks)
  zero_or_one('use_aggressive_host_checking',                @use_aggressive_host_checking)
  zero_or_one('use_daemon_log',                              @use_daemon_log)
  zero_or_one('use_embedded_perl_implicitly',                @use_embedded_perl_implicitly)
  zero_or_one('use_large_installation_tweaks',               @use_large_installation_tweaks)
  zero_or_one('use_regexp_matching',                         @use_regexp_matching)
  zero_or_one('use_retained_program_state',                  @use_retained_program_state)
  zero_or_one('use_retained_scheduling_info',                @use_retained_scheduling_info)
  zero_or_one('use_syslog',                                  @use_syslog)
  zero_or_one('use_syslog_local_facility',                   @use_syslog_local_facility)
  #('use_timezone',                                           @use_timezone)
  zero_or_one('use_true_regexp_matching',                    @use_true_regexp_matching)

-%>
