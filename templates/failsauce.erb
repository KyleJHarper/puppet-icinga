<%
  def ruh_roh(ensure_variable, ensure_pattern, current_value)
    fail "The #{ensure_variable} variable must be one of #{ensure_pattern}, not '#{current_value}'."
  end

  # Shorter names because long strings are annoying to debug later.
  e_file               = scope['icinga::client::ensure_file']
  e_directory          = scope['icinga::client::ensure_directory']
  e_package            = scope['icinga::client::ensure_package']
  e_service            = scope['icinga::client::ensure_service']
  e_nagios_host        = scope['icinga::client::ensure_nagios_host']
  e_nagios_service     = scope['icinga::client::ensure_nagios_service']



  # This is intended to perform a bunch of sanity checking so it's cleaner.
  e_file               =~ /#{@ensure_file_pattern}/      || ruh_roh('ensure_file', @ensure_file_pattern, e_file)
  e_directory          =~ /#{@ensure_directory_pattern}/ || ruh_roh('ensure_directory', @ensure_directory_pattern, e_directory)
  e_package            =~ /#{@ensure_package_pattern}/   || ruh_roh('ensure_package', @ensure_package_pattern, e_package)
  e_service            =~ /#{@ensure_service_pattern}/   || ruh_roh('ensure_service', @ensure_package_pattern, e_service)
  e_nagios_host        =~ /#{@ensure_nagios_pattern}/    || ruh_roh('ensure_nagios_host', @ensure_nagios_pattern, e_nagios_host)
  e_nagios_service     =~ /#{@ensure_nagios_pattern}/    || ruh_roh('ensure_nagios_service', @ensure_nagios_service, e_nagios_service)

-%>
